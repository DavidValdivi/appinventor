/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("blockly/core"),require("blockly/javascript"));else if("function"==typeof define&&define.amd)define(["blockly/core","blockly/javascript"],t);else{var n="object"==typeof exports?t(require("blockly/core"),require("blockly/javascript")):t(e.Blockly,e["Blockly.JavaScript"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,((e,t)=>(()=>{"use strict";var n={370:t=>{t.exports=e},127:e=>{e.exports=t},90:(e,t,n)=>{var r=n(370),o=(n(720),n(605)),s=n(701),i=n(917),a=n(659),l=n(824),c=n(653),u=n(624),d=n(976),_=n(232);delete r.Blocks.global_declaration,r.Blocks.global_declaration={category:"Variables",helpUrl:r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_HELPURL,init:function(){this.setStyle("variable_blocks"),this.appendValueInput("VALUE").appendField(r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT).appendField(new a.l(r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME,i.G.DISPLAY_BELOW),"NAME").appendField(r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO),this.setTooltip(r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP)},getVars:function(){const e=this.getField("NAME");return e?[e.getText()]:[]},getGlobalNames:function(){return this.getVars()},renameVar:function(e,t){r.Names.equals(e,this.getFieldValue("NAME"))&&this.setFieldValue(t,"NAME")}},r.Blocks.lexical_variable_get={category:"Variables",helpUrl:r.Msg.LANG_VARIABLES_GET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new l.b(" "),this.fieldVar_.setBlock(this),this.appendDummyInput().appendField(r.Msg.LANG_VARIABLES_GET_TITLE_GET).appendField(this.fieldVar_,"VAR"),this.setOutput(!0,null),this.setTooltip(r.Msg.LANG_VARIABLES_GET_TOOLTIP),this.errors=[{func:o.N.checkIsInDefinition},{func:o.N.checkDropDownContainsValidValue,dropDowns:["VAR"]}],this.setOnChange((function(e){this.workspace.getWarningHandler().checkErrors(this)}))},referenceResults:function(e,t,n){const o=this.getChildren().map((function(r){return l.f.referenceResult(r,e,t,n)}));let s=[],i=[];for(let e=0;e<o.length;e++)s=s.concat(o[e][0]),i=i.concat(o[e][1]);const a=this.getField("VAR").getText(),c=u.unprefixName(a),d=c[0],_=c[1],p=u.usePrefixInCode&&-1==n.indexOf(a)||!u.usePrefixInCode&&-1==n.indexOf(_);if(d!==r.Msg.LANG_VARIABLES_GLOBAL_PREFIX)if(_===e&&p)if(s.push(this),u.usePrefixInCode)for(let e=0;e<n.length;e++){const r=u.unprefixName(n[e]);t===r[0]&&i.push(r[1])}else i=i.concat(n);else!p||u.usePrefixInCode&&t!==d||i.push(_);return[[s,i]]},getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:function(e,t,n,r){void 0===n?e===this.getFieldValue("VAR")&&this.setFieldValue(t,"VAR"):n&&n===this.fieldVar_.getText()&&(this.fieldVar_.getOptions(!1),this.fieldVar_.setValue(t),e===t&&this.setFieldValue(t,"VAR"),this.fieldVar_.forceRerender())},renameFree:function(e){const t=u.unprefixName(this.getFieldValue("VAR"));if(t[0]!==r.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const n=t[1],r=e.apply(n);r!==n&&this.renameLexicalVar(n,r)}},freeVariables:function(){const e=u.unprefixName(this.getFieldValue("VAR"));if(e[0]!==r.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const t=e[1];return new d.a([t])}return new d.a}},r.Blocks.lexical_variable_set={category:"Variables",helpUrl:r.Msg.LANG_VARIABLES_SET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new l.b(" "),this.fieldVar_.setBlock(this),this.appendValueInput("VALUE").appendField(r.Msg.LANG_VARIABLES_SET_TITLE_SET).appendField(this.fieldVar_,"VAR").appendField(r.Msg.LANG_VARIABLES_SET_TITLE_TO),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_VARIABLES_SET_TOOLTIP),this.errors=[{func:o.N.checkIsInDefinition},{func:o.N.checkDropDownContainsValidValue,dropDowns:["VAR"]}],this.setOnChange((function(e){this.workspace.getWarningHandler().checkErrors(this)}))},referenceResults:r.Blocks.lexical_variable_get.referenceResults,getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:r.Blocks.lexical_variable_get.renameLexicalVar,renameFree:function(e){const t=u.unprefixName(this.getFieldValue("VAR"));if(t[0]!==r.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const n=t[1],r=e.apply(n);r!==n&&this.renameLexicalVar(n,r)}this.getChildren().map((function(t){l.f.renameFree(t,e)}))},freeVariables:function(){const e=this.getChildren().map((function(e){return l.f.freeVariables(e)})),t=d.a.unionAll(e),n=u.unprefixName(this.getFieldValue("VAR"));if(n[0]!==r.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const e=n[1];t.insert(e)}return t}},r.Blocks.local_declaration_statement={category:"Variables",helpUrl:r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("variable_blocks"),this.initLocals(),this.appendStatementInput("STACK").appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP),this.lexicalVarPrefix=u.localNamePrefix},referenceResults:function(e,t,n){const r=[];for(let e=0;this.getInput("DECL"+e);e++){let t=this.getFieldValue("VAR"+e);u.usePrefixInCode&&(t=u.possiblyPrefixMenuNameWith(u.localNamePrefix)(t)),r.push(t)}const o=n.concat(r),s=[];for(let e=0;this.getInput("DECL"+e);e++){const t=this.getInputTargetBlock("DECL"+e);t&&s.push(t)}const i=s.map((function(r){return l.f.referenceResult(r,e,t,n)})),a=l.f.referenceResult(this.getInputTargetBlock("STACK"),e,t,o),c=l.f.referenceResult(l.f.getNextTargetBlock(this),e,t,n);return i.concat([a,c])},withLexicalVarsAndPrefix:function(e,t){if(this.getInputTargetBlock(this.bodyInputName)==e){const e=this.declaredNames();for(let n=0;n<e.length;n++)t(e[n],this.lexicalVarPrefix)}},initLocals:function(){this.setStyle("variable_blocks"),this.localNames_=[r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME],this.appendValueInput("DECL0").appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(0),"VAR0").appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(r.inputs.Align.RIGHT),this.setMutator(new r.icons.MutatorIcon(["local_mutatorarg"],this))},onchange:function(){this.localNames_=this.declaredNames()},mutationToDom:function(){const e=r.utils.xml.createElement("mutation");for(let t=0;t<this.localNames_.length;t++){const n=r.utils.xml.createElement("localname");n.setAttribute("name",this.localNames_[t]),e.appendChild(n)}return e},domToMutation:function(e){const t=c.i0(e);if(t.length>0){this.localNames_=[];for(let e,n=0;e=t[n];n++)"localname"==e.nodeName.toLowerCase()&&this.localNames_.push(e.getAttribute("name"))}this.updateDeclarationInputs_(this.localNames_)},updateDeclarationInputs_:function(e,t){const n=this.inputList[this.inputList.length-1],o=this.inputList.length-1,i=this.rendered;this.rendered=!1;const a=this;s.T.withChangeHanderDisabled((function(){for(let e=0;e<o;e++)a.removeInput("DECL"+e)})),this.inputList=[],this.localNames_=e;for(let n=0;n<e.length;n++){const e=this.appendValueInput("DECL"+n);e.appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(n),"VAR"+n).appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(r.inputs.Align.RIGHT),t&&t[n]&&e.connection.connect(t[n])}this.inputList=this.inputList.concat(n),this.rendered=i,this.rendered&&(this.initSvg(),this.render())},parameterFlydown:function(e){const t=this.localNames_[e],n=this;return new s.T(t,!0,i.G.DISPLAY_RIGHT,(function(t){if(n.localNames_[e]=t,n.mutator&&n.mutator.rootBlock_){let o=0,s=n.mutator.rootBlock_.getInputTargetBlock("STACK");for(;s&&o<e;)s=s.nextConnection&&s.nextConnection.targetBlock(),o++;s&&o==e&&r.Field.prototype.setValue.call(s.getField("NAME"),t)}}))},decompose:function(e){const t=e.newBlock("local_mutatorcontainer");t.initSvg(),t.setDefBlock(this);let n=t.getInput("STACK").connection;for(let t=0;t<this.localNames_.length;t++){const r=this.getFieldValue("VAR"+t),o=e.newBlock("local_mutatorarg");o.initSvg(),o.setFieldValue(r,"NAME"),o.oldLocation=t,n.connect(o.previousConnection),n=o.nextConnection}return t},compose:function(e){const t=[],n=[];let r=e.getInputTargetBlock("STACK");for(;r;)t.push(r.getFieldValue("NAME")),n.push(r.valueConnection_),r=r.nextConnection&&r.nextConnection.targetBlock();l.f.stringListsEqual(this.localNames_,t)||this.updateDeclarationInputs_(t,n)},saveConnections:function(e){let t=e.getInputTargetBlock("STACK"),n=0;for(;t;){const e=this.getInput("DECL"+n);t.valueConnection_=e&&e.connection.targetConnection,n++,t=t.nextConnection&&t.nextConnection.targetBlock()}const r=this.getInput(this.bodyInputName);r&&(e.bodyConnection_=r.connection.targetConnection)},getVars:function(){const e=[];for(let t,n=0;t=this.getField("VAR"+n);n++)e.push(t.getValue());return e},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},initializerConnections:function(){const e=[];for(let t,n=0;t=this.getInput("DECL"+n);n++)e.push(t.connection&&t.connection.targetConnection);return e},blocksInScope:function(){const e=this.getInputTargetBlock(this.bodyInputName);return e&&[e]||[]},renameVar:function(e,t){this.renameVars(_.W.simpleSubstitution(e,t))},renameVars:function(e){const t=this.declaredNames(),n=e.map(t);if(!l.f.stringListsEqual(n,t)){const t=this.initializerConnections();if(this.updateDeclarationInputs_(n,t),this.mutator&&this.mutator.isVisible()){const t=this.mutator.workspace_.getAllBlocks();for(let n,r=0;n=t[r];r++)if("procedures_mutatorarg"==n.type){const t=n.getFieldValue("NAME"),r=e.apply(t);r!==t&&n.setFieldValue(r,"NAME")}}}},renameBound:function(e,t){const n=r.Xml.domToText(this.mutationToDom()),o=this.declaredNames();for(let e=0;e<o.length;e++)l.f.renameFree(this.getInputTargetBlock("DECL"+e),t);const s=e.restrictDomain(o);this.renameVars(s);const i=t.remove(o).extend(s);l.f.renameFree(this.getInputTargetBlock(this.bodyInputName),i);const a=r.Xml.domToText(this.mutationToDom());if(r.Events.isEnabled()&&r.Events.fire(new r.Events.BlockChange(this,"mutation",null,n,a)),this.nextConnection){const e=this.nextConnection.targetBlock();l.f.renameFree(e,t)}},renameFree:function(e){const t=this.declaredNames(),n=new d.a(t),r=l.f.freeVariables(this.getInputTargetBlock(this.bodyInputName));r.subtract(n);const o=r.renamed(e),s=o.intersection(n);if(s.isEmpty())this.renameBound(new _.W,e);else{const t=n.union(o).toList(),r={},i=s.toList();for(let e,n=0;e=i[n];n++){const n=l.b.nameNotIn(e,t);r[e]=n,t.push(n)}this.renameBound(new _.W(r),e)}},freeVariables:function(){const e=l.f.freeVariables(this.getInputTargetBlock(this.bodyInputName)),t=this.declaredNames();e.subtract(new d.a(t));const n=t.length;for(let t=0;t<n;t++)e.unite(l.f.freeVariables(this.getInputTargetBlock("DECL"+t)));if(this.nextConnection){const t=this.nextConnection.targetBlock();e.unite(l.f.freeVariables(t))}return e}},r.Blocks.local_declaration_expression={category:"Variables",helpUrl:r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_HELPURL,initLocals:r.Blocks.local_declaration_statement.initLocals,bodyInputName:"RETURN",init:function(){this.setStyle("variables_blocks"),this.initLocals(),this.appendInputFromRegistry("indented_input","RETURN").appendField(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN),this.setOutput(!0,null),this.setTooltip(r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP)},referenceResults:function(e,t,n){const r=[];for(let e=0;this.getInput("DECL"+e);e++){let t=this.getFieldValue("VAR"+e);u.usePrefixInCode&&(t=u.possiblyPrefixMenuNameWith(u.localNamePrefix)(t)),r.push(t)}const o=n.concat(r),s=[];for(let e=0;this.getInput("DECL"+e);e++){const t=this.getInputTargetBlock("DECL"+e);t&&s.push(t)}const i=s.map((function(r){return l.f.referenceResult(r,e,t,n)})),a=l.f.referenceResult(this.getInputTargetBlock("RETURN"),e,t,o);return i.concat([a])},withLexicalVarsAndPrefix:r.Blocks.local_declaration_statement.withLexicalVarsAndPrefix,onchange:r.Blocks.local_declaration_statement.onchange,mutationToDom:r.Blocks.local_declaration_statement.mutationToDom,domToMutation:r.Blocks.local_declaration_statement.domToMutation,updateDeclarationInputs_:r.Blocks.local_declaration_statement.updateDeclarationInputs_,parameterFlydown:r.Blocks.local_declaration_statement.parameterFlydown,blocksInScope:r.Blocks.local_declaration_statement.blocksInScope,decompose:r.Blocks.local_declaration_statement.decompose,compose:r.Blocks.local_declaration_statement.compose,saveConnections:r.Blocks.local_declaration_statement.saveConnections,getVars:r.Blocks.local_declaration_statement.getVars,declaredNames:r.Blocks.local_declaration_statement.declaredNames,declaredVariables:r.Blocks.local_declaration_statement.declaredVariables,renameVar:r.Blocks.local_declaration_statement.renameVar,renameVars:r.Blocks.local_declaration_statement.renameVars,renameBound:r.Blocks.local_declaration_statement.renameBound,renameFree:r.Blocks.local_declaration_statement.renameFree,freeVariables:r.Blocks.local_declaration_statement.freeVariables},r.Blocks.local_mutatorcontainer={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES),this.appendStatementInput("STACK"),this.setTooltip(r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP),this.contextMenu=!1,this.mustNotRenameCapturables=!0},setDefBlock:function(e){this.defBlock_=e},getDefBlock:function(){return this.defBlock_},declaredNames:function(){const e=[];let t=this.getInputTargetBlock("STACK");for(;t;)e.push(t.getFieldValue("NAME")),t=t.nextConnection&&t.nextConnection.targetBlock();return e}},r.Blocks.local_mutatorarg={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME).appendField(new r.FieldTextInput(r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE,l.f.renameParam),"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(""),this.contextMenu=!1,this.lexicalVarPrefix=u.localNamePrefix,this.mustNotRenameCapturables=!0},getContainerBlock:function(){let e=this.getParent();for(;e&&"local_mutatorcontainer"!==e.type;)e=e.getParent();return this.cachedContainerBlock_=e&&"local_mutatorcontainer"===e.type&&e||null,this.cachedContainerBlock_},getDefBlock:function(){const e=this.getContainerBlock();return e&&e.getDefBlock()||null},blocksInScope:function(){const e=this.getDefBlock();return e&&e.blocksInScope()||[]},declaredNames:function(){const e=this.getContainerBlock();return e&&e.declaredNames()||[]},onchange:function(){const e=this.getFieldValue("NAME");if(e){const t=this.cachedContainerBlock_,n=this.getContainerBlock();if(!t&&n){const t=this.declaredNames(),n=t.indexOf(e);if(-1!=n&&-1!=t.indexOf(e,n+1)){const n=l.b.nameNotIn(e,t);this.setFieldValue(n,"NAME")}}}}},r.Blocks.controls_forRange={category:"Control",helpUrl:r.Msg.LANG_CONTROLS_FORRANGE_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("START").setCheck(c.xb("number",c.bO)).appendField(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM).appendField(new s.T(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR,!0,i.G.DISPLAY_BELOW),"VAR").appendField(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_START).setAlign(r.inputs.Align.RIGHT),this.appendValueInput("END").setCheck(c.xb("number",c.bO)).appendField(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_END).setAlign(r.inputs.Align.RIGHT),this.appendValueInput("STEP").setCheck(c.xb("number",c.bO)).appendField(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP).setAlign(r.inputs.Align.RIGHT),this.appendStatementInput("DO").appendField(r.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO).setAlign(r.inputs.Align.RIGHT),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP),this.lexicalVarPrefix=u.loopRangeParameterPrefix},referenceResults:function(e,t,n){let r=this.getFieldValue("VAR");u.usePrefixInCode&&(r=u.possiblyPrefixMenuNameWith(u.loopRangeParameterPrefix)(r));const o=n.concat([r]);return[l.f.referenceResult(this.getInputTargetBlock("START"),e,t,n),l.f.referenceResult(this.getInputTargetBlock("END"),e,t,n),l.f.referenceResult(this.getInputTargetBlock("STEP"),e,t,n),l.f.referenceResult(this.getInputTargetBlock("DO"),e,t,o),l.f.referenceResult(l.f.getNextTargetBlock(this),e,t,n)]},withLexicalVarsAndPrefix:function(e,t){this.getInputTargetBlock("DO")==e&&t(this.getFieldValue("VAR"),this.lexicalVarPrefix)},getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const e=this.getInputTargetBlock("DO");return e?[e]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(e,t){r.Names.equals(e,this.getFieldValue("VAR"))&&this.setFieldValue(t,"VAR")},renameBound:function(e,t){l.f.renameFree(this.getInputTargetBlock("START"),t),l.f.renameFree(this.getInputTargetBlock("END"),t),l.f.renameFree(this.getInputTargetBlock("STEP"),t);const n=this.getFieldValue("VAR"),r=e.apply(n);if(r!==n){this.renameVar(n,r);const e=_.W.simpleSubstitution(n,r),o=t.extend(e);l.f.renameFree(this.getInputTargetBlock("DO"),o)}else{const e=t.remove([n]);l.f.renameFree(this.getInputTargetBlock("DO"),e)}if(this.nextConnection){const e=this.nextConnection.targetBlock();l.f.renameFree(e,t)}},renameFree:function(e){const t=this.getFieldValue("VAR"),n=l.f.freeVariables(this.getInputTargetBlock("DO"));n.deleteName(t);const r=n.renamed(e);if(r.isMember(t)){const n=l.b.nameNotIn(t,r.toList()),o=_.W.simpleSubstitution(t,n);this.renameBound(o,e)}else this.renameBound(new _.W,e)},freeVariables:function(){const e=l.f.freeVariables(this.getInputTargetBlock("DO"));if(e.deleteName(this.getFieldValue("VAR")),e.unite(l.f.freeVariables(this.getInputTargetBlock("START"))),e.unite(l.f.freeVariables(this.getInputTargetBlock("END"))),e.unite(l.f.freeVariables(this.getInputTargetBlock("STEP"))),this.nextConnection){const t=this.nextConnection.targetBlock();e.unite(l.f.freeVariables(t))}return e}},delete r.Blocks.controls_for,r.Blocks.controls_for=r.Blocks.controls_forRange,r.Blocks.controls_forEach={category:"Control",helpUrl:r.Msg.LANG_CONTROLS_FOREACH_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("LIST").setCheck(c.xb("list",c.bO)).appendField(r.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM).appendField(new s.T(r.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR,!0,i.G.DISPLAY_BELOW),"VAR").appendField(r.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST).setAlign(r.inputs.Align.RIGHT),this.appendStatementInput("DO").appendField(r.Msg.LANG_CONTROLS_FOREACH_INPUT_DO),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_CONTROLS_FOREACH_TOOLTIP),this.lexicalVarPrefix=u.loopParameterPrefix},referenceResults:function(e,t,n){let r=this.getFieldValue("VAR");u.usePrefixInCode&&(r=u.possiblyPrefixMenuNameWith(u.loopParameterPrefix)(r));const o=n.concat([r]);return[l.f.referenceResult(this.getInputTargetBlock("LIST"),e,t,n),l.f.referenceResult(this.getInputTargetBlock("DO"),e,t,o),l.f.referenceResult(l.f.getNextTargetBlock(this),e,t,n)]},withLexicalVarsAndPrefix:r.Blocks.controls_forRange.withLexicalVarsAndPrefix,getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const e=this.getInputTargetBlock("DO");return e?[e]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(e,t){r.Names.equals(e,this.getFieldValue("VAR"))&&this.setFieldValue(t,"VAR")},renameBound:function(e,t){l.f.renameFree(this.getInputTargetBlock("LIST"),t);const n=this.getFieldValue("VAR"),r=e.apply(n);if(r!==n){this.renameVar(n,r);const e=_.W.simpleSubstitution(n,r),o=t.extend(e);l.f.renameFree(this.getInputTargetBlock("DO"),o)}else{const e=t.remove([n]);l.f.renameFree(this.getInputTargetBlock("DO"),e)}if(this.nextConnection){const e=this.nextConnection.targetBlock();l.f.renameFree(e,t)}},renameFree:function(e){const t=this.getFieldValue("VAR"),n=l.f.freeVariables(this.getInputTargetBlock("DO"));n.deleteName(t);const r=n.renamed(e);if(r.isMember(t)){const n=l.b.nameNotIn(t,r.toList()),o=_.W.simpleSubstitution(t,n);this.renameBound(o,e)}else this.renameBound(new _.W,e)},freeVariables:function(){const e=l.f.freeVariables(this.getInputTargetBlock("DO"));if(e.deleteName(this.getFieldValue("VAR")),e.unite(l.f.freeVariables(this.getInputTargetBlock("LIST"))),this.nextConnection){const t=this.nextConnection.targetBlock();e.unite(l.f.freeVariables(t))}return e}},r.Blocks.controls_do_then_return={category:"Control",helpUrl:r.Msg.LANG_CONTROLS_DO_THEN_RETURN_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendStatementInput("STM").appendField(r.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO),this.appendValueInput("VALUE").appendField(r.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN).setAlign(r.inputs.Align.RIGHT),this.setOutput(!0,null),this.setTooltip(r.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP)}};var p=n(374),h=n(526),g=n(793);r.Blocks.procedures_defnoreturn={category:"Procedures",helpUrl:r.Msg.LANG_PROCEDURES_DEFNORETURN_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("procedure_blocks");const e=r.Procedures.findLegalName(r.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE,this);this.createHeader(e),this.horizontalParameters=!0,this.appendStatementInput("STACK").appendField(r.Msg.LANG_PROCEDURES_DEFNORETURN_DO),this.setMutator(new r.icons.MutatorIcon(["procedures_mutatorarg"],this)),this.setTooltip(r.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["STACK"]}],this.lexicalVarPrefix=u.procedureParameterPrefix},createHeader:function(e){return this.appendDummyInput("HEADER").appendField(r.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE).appendField(new p.Z(e),"NAME")},withLexicalVarsAndPrefix:function(e,t){const n=this.declaredNames();for(let e=0;e<n.length;e++)t(n[e],this.lexicalVarPrefix)},onchange:function(){this.arguments_=this.declaredNames()},updateParams_:function(e){e&&(this.arguments_=e);let t=!1;const n={};for(let e=0;e<this.arguments_.length;e++){if(n["arg_"+this.arguments_[e].toLowerCase()]){t=!0;break}n["arg_"+this.arguments_[e].toLowerCase()]=!0}t?this.setWarningText(r.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null);const o=this.getFieldValue("NAME"),i=this.inputList[this.inputList.length-1],a=this.rendered;this.rendered=!1;const l=this;s.T.withChangeHanderDisabled((function(){l.removeInput("HEADER")}));const c=this.inputList.length-1;if(c>0&&this.getInput("VAR0"))for(let e=0;e<c;e++)try{s.T.withChangeHanderDisabled((function(){l.removeInput("VAR"+e)}))}catch(e){console.log(e)}this.inputList=[];const u=this.createHeader(o);if(this.horizontalParameters)for(let e=0;e<this.arguments_.length;e++)u.appendField(" ").appendField(this.parameterFlydown(e),"VAR"+e);else for(let e=0;e<this.arguments_.length;e++)this.appendDummyInput("VAR"+e).appendField(this.parameterFlydown(e),"VAR"+e).setAlign(r.inputs.Align.RIGHT);this.inputList=this.inputList.concat(i),this.rendered=a;for(let e=0;e<this.inputList.length;e++)this.inputList[e].init();this.rendered&&this.render(),this.workspace.loadCompleted&&r.Procedures.mutateCallers(this)},parameterFlydown:function(e){const t=this.arguments_[e],n=this;return new s.T(t,!0,this.horizontalParameters?i.G.DISPLAY_BELOW:i.G.DISPLAY_RIGHT,(function(t){if(n.arguments_[e]=t,r.Procedures.mutateCallers(n),n.mutator&&n.mutator.rootBlock_){let r=0,o=n.mutator.rootBlock_.getInputTargetBlock("STACK");for(;o&&r<e;)o=o.nextConnection&&o.nextConnection.targetBlock(),r++;o&&r==e&&o.getField("NAME").setValue(t)}}))},setParameterOrientation:function(e){0!=this.getParameters().length&&e!==this.horizontalParameters&&(this.horizontalParameters=e,this.updateParams_(),r.Events.isEnabled()&&r.Events.fire(new r.Events.Ui(this,"parameter_orientation",(!this.horizontalParameters).toString(),this.horizontalParameters.toString())))},mutationToDom:function(){const e=r.utils.xml.createElement("mutation");this.horizontalParameters||e.setAttribute("vertical_parameters","true");for(let t=0;t<this.arguments_.length;t++){const n=r.utils.xml.createElement("arg");n.setAttribute("name",this.arguments_[t]),e.appendChild(n)}return e},domToMutation:function(e){const t=[],n=c.i0(e);for(let e,r=0;e=n[r];r++)"arg"==e.nodeName.toLowerCase()&&t.push(e.getAttribute("name"));this.horizontalParameters="true"!==e.getAttribute("vertical_parameters"),this.updateParams_(t)},decompose:function(e){const t=e.newBlock("procedures_mutatorcontainer");t.initSvg(),t.setProcBlock(this),this.paramIds_=[];let n=t.getInput("STACK").connection;for(let t=0;t<this.arguments_.length;t++){const r=e.newBlock("procedures_mutatorarg");this.paramIds_.push(r.id),r.initSvg(),r.setFieldValue(this.arguments_[t],"NAME"),r.oldLocation=t,n.connect(r.previousConnection),n=r.nextConnection}return r.Procedures.mutateCallers(this),t},compose:function(e){const t=[];this.paramIds_=[];let n=e.getInputTargetBlock("STACK");for(;n;)t.push(n.getFieldValue("NAME")),this.paramIds_.push(n.id),n=n.nextConnection&&n.nextConnection.targetBlock();l.f.stringListsEqual(t,this.arguments_)||(this.updateParams_(t),r.Procedures.mutateCallers(this))},dispose:function(...e){const t=this.getFieldValue("NAME"),n=this.editable_,r=this.workspace;n&&h.WU(t,r),Object.getPrototypeOf(this).dispose.apply(this,e);const o=r.getProcedureDatabase();n&&o&&o.removeProcedure(this.id)},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,"RETURN"===this.bodyInputName]},getVars:function(){const e=[];for(let t,n=0;t=this.getFieldValue("VAR"+n);n++)e.push(t);return e},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},renameVar:function(e,t){this.renameVars(_.W.simpleSubstitution(e,t))},renameVars:function(e){const t=this.getParameters(),n=e.map(t);if(!l.f.stringListsEqual(t,n)&&(this.updateParams_(n),this.mutator.isVisible())){const t=this.mutator.workspace_.getAllBlocks();for(let n,r=0;n=t[r];r++)if("procedures_mutatorarg"==n.type){const t=n.getFieldValue("NAME"),r=e.apply(t);r!==t&&n.setFieldValue(r,"NAME")}}},renameBound:function(e,t){const n=e.restrictDomain(this.declaredNames());this.renameVars(n);const r=t.extend(n);l.f.renameFree(this.getInputTargetBlock(this.bodyInputName),r)},renameFree:function(e){this.freeVariables()},freeVariables:function(){const e=l.f.freeVariables(this.getInputTargetBlock(this.bodyInputName));if(e.subtract(new NameSet(this.declaredNames())),e.isEmpty())return e;throw Error("Violation of invariant: procedure declaration has nonempty free variables: "+e.toString())},blocksInScope:function(){const e=this.getInputTargetBlock(this.bodyInputName);return e&&[e]||[]},customContextMenu:function(e){s.T.addHorizontalVerticalOption(this,e)},getParameters:function(){return this.arguments_}},r.Blocks.procedures_defreturn={category:"Procedures",helpUrl:r.Msg.PROCEDURES_DEFRETURN_HELPURL,bodyInputName:"RETURN",init:function(){this.setStyle("procedure_blocks");const e=r.Procedures.findLegalName(r.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE,this);this.createHeader(e),this.horizontalParameters=!0,this.appendInputFromRegistry("indented_input","RETURN").setAlign(r.inputs.Align.RIGHT).appendField(r.Msg.LANG_PROCEDURES_DEFRETURN_RETURN),this.setMutator(new r.icons.MutatorIcon(["procedures_mutatorarg"],this)),this.setTooltip(r.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["RETURN"]}]},createHeader:function(e){return this.appendDummyInput("HEADER").appendField(r.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE).appendField(new p.Z(e),"NAME")},withLexicalVarsAndPrefix:r.Blocks.procedures_defnoreturn.withLexicalVarsAndPrefix,onchange:r.Blocks.procedures_defnoreturn.onchange,updateParams_:r.Blocks.procedures_defnoreturn.updateParams_,parameterFlydown:r.Blocks.procedures_defnoreturn.parameterFlydown,setParameterOrientation:r.Blocks.procedures_defnoreturn.setParameterOrientation,mutationToDom:r.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:r.Blocks.procedures_defnoreturn.domToMutation,decompose:r.Blocks.procedures_defnoreturn.decompose,compose:r.Blocks.procedures_defnoreturn.compose,dispose:r.Blocks.procedures_defnoreturn.dispose,getProcedureDef:r.Blocks.procedures_defnoreturn.getProcedureDef,getVars:r.Blocks.procedures_defnoreturn.getVars,declaredNames:r.Blocks.procedures_defnoreturn.declaredNames,declaredVariables:r.Blocks.procedures_defnoreturn.declaredVariables,renameVar:r.Blocks.procedures_defnoreturn.renameVar,renameVars:r.Blocks.procedures_defnoreturn.renameVars,renameBound:r.Blocks.procedures_defnoreturn.renameBound,renameFree:r.Blocks.procedures_defnoreturn.renameFree,freeVariables:r.Blocks.procedures_defnoreturn.freeVariables,blocksInScope:r.Blocks.procedures_defnoreturn.blocksInScope,customContextMenu:r.Blocks.procedures_defnoreturn.customContextMenu,getParameters:r.Blocks.procedures_defnoreturn.getParameters},r.Blocks.procedures_mutatorcontainer={init:function(){this.setStyle("procedure_blocks"),this.appendDummyInput().appendField(r.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.setTooltip(r.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1,this.mustNotRenameCapturables=!0},setProcBlock:function(e){this.procBlock_=e},getProcBlock:function(){return this.procBlock_},declaredNames:function(){const e=[];let t=this.getInputTargetBlock("STACK");for(;t;)e.push(t.getFieldValue("NAME")),t=t.nextConnection&&t.nextConnection.targetBlock();return e}},r.Blocks.procedures_mutatorarg={init:function(){this.setStyle("procedure_blocks");const e=new r.FieldTextInput("x",l.f.renameParam);e.onHtmlInputChange_=function(e){const t=this.getValue();i.G.prototype.onHtmlInputChange_.call(this,e);const n=this.getValue();n&&t!==n&&r.Events.isEnabled()&&r.Events.fire(new r.Events.BlockChange(this.sourceBlock_,"field",this.name,t,n))},this.appendDummyInput().appendField(r.Msg.LANG_PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,this.lexicalVarPrefix=u.procedureParameterPrefix,this.mustNotRenameCapturables=!0},getContainerBlock:function(){let e=this.getParent();for(;e&&"procedures_mutatorcontainer"!==e.type;)e=e.getParent();return this.cachedContainerBlock_=e&&"procedures_mutatorcontainer"===e.type&&e||null,this.cachedContainerBlock_},getProcBlock:function(){const e=this.getContainerBlock();return e&&e.getProcBlock()||null},declaredNames:function(){const e=this.getContainerBlock();return e&&e.declaredNames()||[]},blocksInScope:function(){const e=this.getProcBlock();return e&&e.blocksInScope()||[]},onchange:function(){const e=this.getFieldValue("NAME");if(e){const t=this.cachedContainerBlock_,n=this.getContainerBlock();if(!t&&n){const t=this.declaredNames(),n=t.indexOf(e);if(-1!=n&&-1!=t.indexOf(e,n+1)){const n=l.b.nameNotIn(e,t);this.setFieldValue(n,"NAME")}}}}},r.Blocks.procedures_mutatorarg.validator=function(e){return(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))||null},r.Blocks.procedures_callnoreturn={category:"Procedures",helpUrl:r.Msg.LANG_PROCEDURES_CALLNORETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const e=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const t=e.getMenuItems(!1);return t.length>0?t:["",""]},this.procDropDown=new g.f(this.procNamesFxn,h.k9),this.procDropDown.block=this,this.appendDummyInput().appendField(r.Msg.LANG_PROCEDURES_CALLNORETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:o.N.checkIsInDefinition},{func:o.N.checkDropDownContainsValidValue,dropDowns:["PROCNAME"]}],this.setOnChange((function(e){this.workspace.getWarningHandler().checkErrors(this)})),h.k9.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:function(){return this.getFieldValue("PROCNAME")},renameProcedure:function(e,t){e&&!r.Names.equals(e,this.getFieldValue("PROCNAME"))||(this.getField("PROCNAME").getOptions(),this.setFieldValue(t,"PROCNAME"))},setProcedureParameters:function(e,t,n){let o,s,i;if(t||(this.quarkConnections_={},this.quarkArguments_=null,t=[].concat(e)),t.length!=e.length)throw Error("Error: paramNames and paramIds must be the same length.");const a={};for(let n=0;n<e.length;n++)a[t[n]]=e[n];void 0===n&&(n=null),this.quarkArguments_&&!n||(this.quarkConnections_={},l.f.stringListsEqual(e,this.arguments_)||n?this.quarkArguments_=t:this.quarkArguments_=[]);const c=this.rendered;for(this.rendered=!1,i=0;this.getInput("ARG"+i);i++)o=this.getInput("ARG"+i),o&&(s=o.connection.targetConnection,this.quarkConnections_[this.quarkArguments_[i]]=s,this.removeInput("ARG"+i));for(this.arguments_=[].concat(e),this.quarkArguments_=t,i=0;i<this.arguments_.length;i++)if(o=this.appendValueInput("ARG"+i).setAlign(r.inputs.Align.RIGHT).appendField(this.arguments_[i]),this.quarkArguments_){const e=this.quarkArguments_[i];e in this.quarkConnections_?(s=this.quarkConnections_[e],!s||s.targetConnection||s.sourceBlock_.workspace!=this.workspace?delete this.quarkConnections_[e]:o.connection.connect(s)):a[e]&&(s=this.quarkConnections_[a[e]],s&&o.connection.connect(s))}if(this.rendered=c,this.workspace.rendered){for(i=0;i<this.arguments_.length;i++)this.getInput("ARG"+i).init();this.rendered&&this.render()}},mutationToDom:function(){const e=r.utils.xml.createElement("mutation");e.setAttribute("name",this.getFieldValue("PROCNAME"));for(let t=0;this.getInput("ARG"+t);t++){const n=r.utils.xml.createElement("arg");n.setAttribute("name",this.getInput("ARG"+t).fieldRow[0].getText()),e.appendChild(n)}return e},domToMutation:function(e){const t=e.getAttribute("name");this.setFieldValue(t,"PROCNAME"),this.arguments_=[];const n=c.i0(e);for(let e,t=0;e=n[t];t++)"arg"==e.nodeName.toLowerCase()&&this.arguments_.push(e.getAttribute("name"));this.setProcedureParameters(this.arguments_,null,!0)},renameVar:function(e,t){for(let n=0;n<this.arguments_.length;n++)r.Names.equals(e,this.arguments_[n])&&(this.arguments_[n]=t,this.getInput("ARG"+n).fieldRow[0].setValue(t))},procCustomContextMenu:function(e){const t={enabled:!0};t.text=r.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF;const n=this.getFieldValue("PROCNAME"),o=this.workspace;t.callback=function(){const e=r.Procedures.getDefinition(n,o);e&&(e.select(),o.centerOnBlock(e.id),o.getParentSvg().parentElement.focus())},e.push(t)},removeProcedureValue:function(){for(let e=0;null!==this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);this.setFieldValue("none","PROCNAME")}},r.Blocks.procedures_callreturn={category:"Procedures",helpUrl:r.Msg.LANG_PROCEDURES_CALLRETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const e=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const t=e.getMenuItems(!0);return t.length>0?t:["",""]},this.procDropDown=new g.f(this.procNamesFxn,h.k9),this.procDropDown.block=this,this.appendDummyInput().appendField(r.Msg.LANG_PROCEDURES_CALLRETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setOutput(!0,null),this.setTooltip(r.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:o.N.checkIsInDefinition},{func:o.N.checkDropDownContainsValidValue,dropDowns:["PROCNAME"]}],this.setOnChange((function(e){this.workspace.getWarningHandler().checkErrors(this)})),h.k9.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:r.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:r.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:r.Blocks.procedures_callnoreturn.setProcedureParameters,mutationToDom:r.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:r.Blocks.procedures_callnoreturn.domToMutation,renameVar:r.Blocks.procedures_callnoreturn.renameVar,procCustomContextMenu:r.Blocks.procedures_callnoreturn.procCustomContextMenu,removeProcedureValue:r.Blocks.procedures_callnoreturn.removeProcedureValue}},486:(e,t,n)=>{n.d(t,{LexicalVariablesPlugin:()=>T});var r=n(370);n(653);var o=n(605),s=(n(720),n(526));const i=function(e){this.workspace_=e,this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};i.defaultValue=["","none"],i.prototype.getNames=function(e){return s.Qp(e,this.workspace_).map((function(e){return e[0]}))},i.prototype.getMenuItems=function(e){return s.Qp(e,this.workspace_)},i.prototype.getDeclarationBlocks=function(e){return r.utils.object.values(e?this.returnProcedures_:this.voidProcedures_)},i.prototype.getDeclarationsBlocksExcept=function(e){const t=[];return r.utils.values(this.procedures_).forEach((function(n){n!==e&&t.push(n)})),t},i.prototype.getAllDeclarationNames=function(){return r.utils.values(this.procedures_).map((function(e){return e.getFieldValue("NAME")}))},i.prototype.addProcedure=function(e,t){if("procedures_defnoreturn"!=t.type&&"procedures_defreturn"!=t.type)return console.warn("Attempt to addProcedure with block type "+t.type),!1;const n=t.id;return!(n in this.procedures_)&&(this.procedures_[n]=t,this.length++,"procedures_defnoreturn"==t.type?(this.voidProcedures_[n]=t,this.voidProcedures++):(this.returnProcedures_[n]=t,this.returnProcedures++),!0)},i.prototype.removeProcedure=function(e){return e in this.procedures_&&("procedures_defnoreturn"==this.procedures_[e].type?(delete this.voidProcedures_[e],this.voidProcedures--):(delete this.returnProcedures_[e],this.returnProcedures--),delete this.procedures_[e],this.length--),!0},i.prototype.renameProcedure=function(e,t,n){},i.prototype.getProcedure=function(e){return this.procedures_[e]||this.getProcedureByName(e)},i.prototype.getProcedureByName=function(e){for(const t in this.procedures_)if(this.procedures_[t].getFieldValue("NAME")===e)return this.procedures_[t]},i.prototype.clear=function(){this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0},r.Workspace.prototype.flydown_=r.Workspace.prototype.flydown_||null,r.Workspace.prototype.getFlydown=r.Workspace.prototype.getFlydown||function(){return this.flydown_},r.Workspace.prototype.getProcedureDatabase=r.Workspace.prototype.getProcedureDatabase||function(){return this.procedureDb_||(this.procedureDb_=new i(this)),this.procedureDb_},r.Workspace.prototype.getTopWorkspace=r.Workspace.prototype.getTopWorkspace||function(){let e=this;for(;e.targetWorkspace;)e=e.targetWorkspace;return e},r.Workspace.prototype.getWarningHandler=r.Workspace.prototype.getWarningHandler||function(){return this.warningHandler_||(this.warningHandler_=new o.A),this.warningHandler_},r.WorkspaceSvg.prototype.flydown_=r.WorkspaceSvg.prototype.flydown_||null,r.WorkspaceSvg.prototype.getFlydown=r.WorkspaceSvg.prototype.getFlydown||function(){return this.flydown_},r.WorkspaceSvg.prototype.getProcedureDatabase=r.WorkspaceSvg.prototype.getProcedureDatabase||function(){return this.procedureDb_||(this.procedureDb_=new i(this)),this.procedureDb_},r.WorkspaceSvg.prototype.getTopWorkspace=r.WorkspaceSvg.prototype.getTopWorkspace||function(){let e=this;for(;e.targetWorkspace;)e=e.targetWorkspace;return e},r.WorkspaceSvg.prototype.getWarningHandler=r.WorkspaceSvg.prototype.getWarningHandler||function(){return o.A};class a extends r.inputs.ValueInput{constructor(e,t){super(e,t),this.connection=this.makeConnection(r.ConnectionType.INPUT_VALUE),this.type=r.inputTypes.VALUE}}r.registry.register(r.registry.Type.INPUT,"indented_input",a);var l=n(917);class c extends r.VerticalFlyout{constructor(e){super(e),this.dragAngleRange_=360}}c.prototype.previousCSSClassName_="",c.prototype.VERTICAL_SEPARATION_FACTOR=1,c.prototype.createDom=function(e){return this.previousCSSClassName_=e,this.svgGroup_=r.utils.dom.createSvgElement("g",{class:e},null),this.svgBackground_=r.utils.dom.createSvgElement("path",{},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_},c.prototype.setCSSClass=function(e){e!==this.previousCSSClassName_&&(r.utils.dom.removeClass(this.svgGroup_,this.previousCSSClassName_),r.utils.dom.addClass(this.svgGroup_,e),this.previousCSSClassName_=e)},c.prototype.init=function(e){r.Flyout.prototype.init.call(this,e,!1),this.workspace_.setTheme(e.getTheme()),e.getComponentManager().addCapability(this.id,r.ComponentManager.Capability.AUTOHIDEABLE)},c.prototype.position=function(){},c.prototype.showAt=function(e,t,n){r.Events.disable();try{this.show(e)}finally{r.Events.enable()}const o=this.CORNER_RADIUS*this.workspace_.scale,s=this.width_-2*o,i=this.height_-2*o,a=["M 0,"+o];a.push("a",o,o,0,0,1,o,-o),a.push("h",s),a.push("a",o,o,0,0,1,o,o),a.push("v",i),a.push("a",o,o,0,0,1,-o,o),a.push("h",-s),a.push("a",o,o,0,0,1,-o,-o),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" ")),this.svgGroup_.setAttribute("transform","translate("+t+", "+n+")")},c.prototype.reflow=function(){this.workspace_.scale=this.targetWorkspace.scale;const e=this.workspace_.scale;let t=0,n=0;const r=this.CORNER_RADIUS*e,o=this.workspace_.getTopBlocks(!1);for(let r,s=0;r=o[s];s++){const o=r.getHeightWidth();t=Math.max(t,o.width*e),n+=o.height*e}t+=2*r+this.tabWidth_*e;const s=this.workspace_.getRenderer().getConstants(),i=s.ADD_START_HATS?s.START_HAT_HEIGHT:0;if(n+=3*r+r*this.VERTICAL_SEPARATION_FACTOR*o.length+i*e/2,this.width_!=t){for(let n,s=0;n=o[s];s++){const o=n.getHeightWidth(),s=n.getRelativeToSurfaceXY();if(this.RTL){const o=t-r-e*(this.tabWidth_-s.x);n.moveBy(o,0),s.x+=o}n.flyoutRect_&&(n.flyoutRect_.setAttribute("width",o.width),n.flyoutRect_.setAttribute("height",o.height),n.flyoutRect_.setAttribute("x",this.RTL?s.x-o.width:s.x),n.flyoutRect_.setAttribute("y",s.y))}this.width_=t,this.height_=n}},c.prototype.onMouseMove_=function(e){},c.prototype.placeNewBlock_=function(e){const t=this.targetWorkspace,n=e.getSvgRoot();if(!n)throw Error("originBlock is not rendered.");let o=this.workspace_.scale;const s=this.workspace_.getSvgXY(n),i=s.x;s.x+=i/t.scale-i;const a=s.y;o=t.scale,s.y+=a/o-a;const l=r.Xml.blockToDom(e),c=r.Xml.domToBlock(l,t),u=c.getSvgRoot();if(!u)throw Error("block is not rendered.");const d=t.getSvgXY(u);return d.x+=t.scrollX/t.scale-t.scrollX,d.y+=t.scrollY/t.scale-t.scrollY,t.toolbox_&&!t.scrollbar&&(d.x+=t.toolbox_.getWidth()/t.scale,d.y+=t.toolbox_.getHeight()/t.scale),c.moveBy(s.x-d.x,s.y-d.y),c},c.prototype.shouldHide=!0,c.prototype.hide=function(){this.shouldHide&&(r.Flyout.prototype.hide.call(this),l.G.openFieldFlydown_=null),this.shouldHide=!0},c.prototype.autoHide=function(){this.hide()};var u=n(659),d=n(793),_=n(824),p=n(701),h=n(374),g=n(976),f=n(624),A=n(232);class m extends r.blockRendering.ExternalValueInput{constructor(e,t){super(e,t),this.connectedBlock?this.height=this.connectedBlockHeight:this.height=this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT}}class R extends r.geras.Highlighter{constructor(e){super(e)}drawIndentedInput(e){const t=e.getLastInput();if(this.RTL_){const n=e.height-t.connectionHeight-t.connectionOffsetY;this.steps_+=r.utils.svgPaths.moveTo(t.xPos+this.highlightOffset+t.connectionWidth-1,e.yPos)+r.utils.svgPaths.lineOnAxis("v",t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)+r.utils.svgPaths.lineOnAxis("v",n)}else this.steps_+=r.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,e.yPos+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)+r.utils.svgPaths.moveTo(t.xPos+t.connectionWidth+1,e.yPos+t.height)}}class E extends r.geras.Drawer{constructor(e,t){super(e,t),this.highlighter_=new R(t)}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.getLastInput()instanceof m?this.drawIndentedInput_(t):t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawIndentedInput_(e){const t=e.getLastInput();this.positionIndentedValueConnection_(e),this.highlighter_.drawIndentedInput(e);const n="function"==typeof t.shape.pathDown?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=r.utils.svgPaths.lineOnAxis("H",t.xPos+t.connectionWidth)+r.utils.svgPaths.lineOnAxis("v",t.connectionOffsetY)+n+r.utils.svgPaths.lineOnAxis("v",e.height-t.connectionHeight-t.connectionOffsetY)+r.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)}positionIndentedValueConnection_=function(e){const t=e.getLastInput();if(t.connectionModel){let n=e.xPos+e.statementEdge+e.constants_.TAB_WIDTH;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos+t.connectionOffsetY)}}}class N extends r.geras.RenderInfo{addInput_(e,t){e instanceof a?(t.elements.push(new m(this.constants_,e)),t.hasStatement=!0):super.addInput_(e,t)}}class L extends r.geras.Renderer{makeRenderInfo_(e){return new N(this,e)}makeDrawer_(e,t){return new E(e,t)}}r.Css.register("\n  .blocklyFieldParameter>rect {\n    fill: rgb(222, 143, 108);\n    fill-opacity: 1.0;\n    stroke-width: 2;\n    stroke: rgb(231, 175, 150);\n  }\n  .blocklyFieldParameter>text {\n    stroke-width: 1;\n    fill: #000;\n  }\n  .blocklyFieldParameter:hover>rect {\n    stroke-width: 2;\n    stroke: rgb(231,175,150);\n    fill: rgb(231,175,150);\n    fill-opacity: 1.0;\n  }\n  /*\n   * [lyn, 10/08/13] Control flydown with the getter/setter blocks.\n   */\n  .blocklyFieldParameterFlydown {\n    fill: rgb(231,175,150);\n    fill-opacity: 0.8;\n  }\n  /*\n   * [lyn, 10/08/13] Control parameter fields with flydown procedure\n   * caller block.\n   */\n  .blocklyFieldProcedure>rect {\n    fill: rgb(215,203,218);\n    fill-opacity: 1.0;\n    stroke-width: 0;\n    stroke: #000;\n  }\n  .blocklyFieldProcedure>text {\n    fill: #000;\n  }\n  .blocklyFieldProcedure:hover>rect {\n    stroke-width: 2;\n    stroke: #fff;\n    fill: rgb(215,203,218);\n    fill-opacity: 1.0;\n  }\n  /*\n   * [lyn, 10/08/13] Control flydown with the procedure caller block.\n   */\n  .blocklyFieldProcedureFlydown {\n    fill: rgb(215,203,218);\n    fill-opacity: 0.8;\n  }\n");class T{static init(e){const t=new c(new r.Options({scrollbars:!1,rtl:e.RTL,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,parentWorkspace:e}));e.flydown_=t,r.utils.dom.insertAfter(t.createDom("g"),e.svgBubbleCanvas_),t.init(e),t.autoClose=!0}static Flydown=c;static FieldFlydown=l.G;static FieldGlobalFlydown=u.l;static FieldParameterFlydown=p.T;static LexicalVariable=_.f;static FieldLexicalVariable=_.b;static FieldProcedureName=h.Z;static FieldNoCheckDropdown=d.f;static NameSet=g.a;static Shared=f;static Substitution=A.W}r.blockRendering.register("geras2_renderer",L)},917:(e,t,n)=>{n.d(t,{G:()=>s});var r=n(370),o=n(653);class s extends r.FieldTextInput{static timeout=500;static showPid_=0;static openFieldFlydown_=null;static DISPLAY_BELOW="BELOW";static DISPLAY_RIGHT="RIGHT";static DISPLAY_LOCATION=s.DISPLAY_BELOW;constructor(e,t,n,r){super(e,r),this.EDITABLE=t,this.displayLocation=n||s.DISPLAY_RIGHT}showEditor_(){this.EDITABLE&&(s.showPid_&&(clearTimeout(s.showPid_),s.showPid_=0,r.common.getMainWorkspace().hideChaff()),super.showEditor_())}init(e){super.init(e),r.utils.dom.removeClass(this.fieldGroup_,"blocklyEditableText"),r.utils.dom.removeClass(this.fieldGroup_,"blocklyNoNEditableText"),r.utils.dom.addClass(this.fieldGroup_,this.fieldCSSClassName),this.mouseOverWrapper_=r.browserEvents.bind(this.fieldGroup_,"mouseover",this,this.onMouseOver_),this.mouseOutWrapper_=r.browserEvents.bind(this.fieldGroup_,"mouseout",this,this.onMouseOut_)}}s.prototype.fieldCSSClassName="blocklyFieldFlydownField",s.prototype.flyoutCSSClassName="blocklyFieldFlydownFlydown",s.prototype.onMouseOver_=function(e){this.sourceBlock_.isInFlyout||0!=s.showPid_||(s.showPid_=window.setTimeout(this.showFlydownMaker_(),s.timeout)),e.stopPropagation()},s.prototype.onMouseOut_=function(e){window.clearTimeout(s.showPid_),s.showPid_=0,e.stopPropagation()},s.prototype.showFlydownMaker_=function(){const e=this;return function(){if(0!==s.showPid_&&!e.getSourceBlock().workspace.isDragging()&&!this.htmlInput_)try{e.showFlydown_()}catch(e){console.error("Failed to show flydown",e)}s.showPid_=0}},s.prototype.showFlydown_=function(){r.common.getMainWorkspace().hideChaff();const e=r.common.getMainWorkspace().getFlydown();r.common.getMainWorkspace().getParentSvg().appendChild(e.svgGroup_);const t=e.targetWorkspace.scale;e.workspace_.setScale(t),e.setCSSClass(this.flyoutCSSClassName);const n=this.flydownBlocksXML_(),i=r.utils.xml.textToDom(n),a=o.i0(i),l=r.common.getMainWorkspace().getSvgXY(this.borderRect_),c=this.borderRect_.getBBox();this.displayLocation===s.DISPLAY_BELOW?l.y+=c.height*t:l.x+=c.width*t,e.field_=this,e.showAt(a,l.x,l.y),s.openFieldFlydown_=this},s.hide=function(){window.clearTimeout(s.showPid_);const e=r.common.getMainWorkspace().getFlydown();e&&e.hide()},s.prototype.onHtmlInputChange_=function(e){const t=this.htmlInput_,n=t.value;if(n!==t.oldValue_){t.oldValue_=n;let e=!0;this.sourceBlock_&&(e=function(e,t){const n=e.doClassValidation_(t);if(null===n)return null;void 0!==n&&(t=n);const r=e.getValidator();if(r){const n=r.call(e,t);if(null===n)return null;void 0!==n&&(t=n)}return t}(this,t.value)),null===e?r.utils.dom.addClass(t,"blocklyInvalidInput"):(r.utils.dom.removeClass(t,"blocklyInvalidInput"),this.doValueUpdate_(e))}else r.utils.userAgent.WEBKIT&&this.sourceBlock_.render();this.textContent_.nodeValue=n,this.forceRerender(),this.resizeEditor_(),r.svgResize(this.sourceBlock_.workspace)},s.prototype.dispose=function(){s.openFieldFlydown_==this&&s.hide(),r.FieldTextInput.prototype.dispose.call(this)},s.fromJson=function(e){const t=r.utils.replaceMessageReferences(e.name);return new s(t,e.is_editable)},r.fieldRegistry.register("field_flydown",s)},659:(e,t,n)=>{n.d(t,{l:()=>i});var r=n(370),o=(n(720),n(917)),s=n(824);class i extends o.G{constructor(e,t){super(e,!0,t,s.f.renameGlobal)}}i.prototype.fieldCSSClassName="blocklyFieldParameter",i.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown",i.prototype.flydownBlocksXML_=function(){const e=r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "+this.getText();return'<xml><block type="lexical_variable_get"><title name="VAR">'+e+'</title></block><block type="lexical_variable_set"><title name="VAR">'+e+"</title></block></xml>"},i.fromJson=function(e){const t=r.utils.replaceMessageReferences(e.name);return new i(t)},r.fieldRegistry.register("field_global_flydown",i)},824:(e,t,n)=>{n.d(t,{b:()=>a,f:()=>c});var r=n(370);n(720);var o=n(624),s=n(976),i=n(232);class a extends r.FieldDropdown{constructor(e){super(a.dropdownCreate),e?this.doValueUpdate_(e):this.doValueUpdate_(r.Variables.generateUniqueName())}}a.prototype.doClassValidation_=function(e){return e},a.prototype.getBlock=function(){return this.block_},a.prototype.setBlock=function(e){this.block_=e},a.getGlobalNames=function(e){const t=r.common.getMainWorkspace(),n=t.getRootWorkspace()||t;if(n&&n.getWarningHandler&&n.getWarningHandler().cacheGlobalNames)return n.getWarningHandler().cachedGlobalNames;const o=[];if(n&&!n.isFlyout){let t=[];t=n.getTopBlocks();for(let n=0;n<t.length;n++){const r=t[n];r.getGlobalNames&&r!=e&&o.push(...r.getGlobalNames())}}return o},a.prototype.getNamesInScope=function(){return a.getNamesInScope(this.block_)},a.getNamesInScope=function(e){let t=a.getGlobalNames();t=c.sortAndRemoveDuplicates(t),t=t.map((function(e){return[o.prefixGlobalMenuName(e),"global "+e]}));const n=a.getLexicalNamesInScope(e);return t.concat(n)},a.getLexicalNamesInScope=function(e){let t=[];const n={};let r,s;function i(e,t,r){let s;o.usePrefixInCode?s=o.possiblyPrefixMenuNameWith(r)(e):(n[e]||(n[e]=r),s=o.possiblyPrefixMenuNameWith(n[e])(e)),t.push(s)}if(s=e,s&&(r=s.getParent(),r))for(;r;)r.withLexicalVarsAndPrefix&&r.withLexicalVarsAndPrefix(s,((e,n)=>{i(e,t,n)})),s=r,r=r.getParent();return t=c.sortAndRemoveDuplicates(t),t.map((function(e){return[e,e]}))},a.dropdownCreate=function(){const e=this.getNamesInScope();return 0==e.length?[[" "," "]]:e},a.prototype.doValueUpdate_=function(e){if(Object.getPrototypeOf(r.FieldDropdown).prototype.doValueUpdate_.call(this,e),e&&" "!==e){const t=e.split(" ");2==t.length&&"global"!==t[0]&&(e="global "+t[1])}this.value_=e;const t=this.getOptions(!0,[[(n=e,n.startsWith("global ")?n.replace("global ",r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "):n),e]]);var n;for(let e,n=0;e=t[n];n++)if(e[1]==this.value_){this.selectedOption=e;break}this.updateMutation(),this.forceRerender()},a.prototype.updateMutation=function(){const e=this.getText();if(this.sourceBlock_&&this.sourceBlock_.getParent()){if(this.sourceBlock_.eventparam=void 0,0===e.indexOf(r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "))return void(this.sourceBlock_.eventparam=null);let t,n=this.sourceBlock_.getParent();for(;n;){const r=n.declaredVariables?n.declaredVariables():[];if("component_event"!=n.type){for(t=0;t<r.length;t++)if(r[t]==e)return void(this.sourceBlock_.eventparam=null)}else for(t=0;t<r.length;t++)if(r[t]==e)return void(this.sourceBlock_.eventparam=n.getParameters()[t].name);n=n.getParent()}}},a.prototype.getOptions=function(e,t){Array.isArray(e)&&(t=e);const n=t||[];return this.isOptionListDynamic()?(this.generatedOptions_&&e||(this.generatedOptions_=this.menuGenerator_.call(this).concat(n),l(this.generatedOptions_)),this.generatedOptions_.concat(n)):this.menuGenerator_};const l=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;++n){const r=e[n];Array.isArray(r)?"string"!=typeof r[1]?(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",r))}if(t)throw TypeError("Found invalid FieldDropdown options.")};a.dropdownChange=function(e){if(e){this.doValueUpdate_(e);const t=this.sourceBlock_.workspace.getTopWorkspace();t.getWarningHandler&&t.getWarningHandler().checkErrors(this.sourceBlock_)}},a.nameNotIn=function(e,t){const n=a.prefixSuffix(e),r=n[0],o=n[1];let s=!1,i=!1;const l=[];for(let e=0;e<t.length;e++){const n=a.prefixSuffix(t[e]),c=n[0],u=n[1];c===r&&(u===o&&(i=!0),""===u?s=!0:l.push(u))}if(i){if(s){const e=l.map((function(e,t,n){return parseInt(e,10)}));e.sort((function(e,t){return e-t}));let t=2,n=0;for(;n<e.length;){if(t<e[n])return r+t;t==e[n]?(t++,n++):n++}return r+t}return r}return e},a.prefixSuffix=function(e){const t=e.match(/^(.*?)(\d+)$/);return t?[t[1],t[2]]:[e,""]},a.fromJson=function(e){const t=r.utils.replaceMessageReferences(e.name);return new a(t)},r.fieldRegistry.register("field_lexical_variable",a);const c={renameGlobal:function(e){const t=this.value_;e=c.makeLegalIdentifier(e),this.sourceBlock_.getField("NAME").doValueUpdate_(e);const n=a.getGlobalNames(this.sourceBlock_);if(e=a.nameNotIn(e,n),this.sourceBlock_.rendered&&r.common.getMainWorkspace()){const n=r.common.getMainWorkspace().getAllBlocks();for(let s=0;s<n.length;s++){const i=n[s],a=i.renameLexicalVar;a&&a.call(i,o.GLOBAL_KEYWORD+o.menuSeparator+t,o.GLOBAL_KEYWORD+o.menuSeparator+e,r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+o.menuSeparator+t,r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+o.menuSeparator+e)}}return e},renameParam:function(e){const t=this.htmlInput_,n=this.getValue()||t&&t.defaultValue||this.getText();return e=c.makeLegalIdentifier(e),c.renameParamFromTo(this.sourceBlock_,n,e,!1)},renameParamFromTo:function(e,t,n,r){return e.mustNotRenameCapturables?c.renameParamWithoutRenamingCapturables(e,t,n,[]):r?(c.renameParamRenamingCapturables(e,t,n),n):c.renameParamWithoutRenamingCapturables(e,t,n,[])},renameParamRenamingCapturables:function(e,t,n){if(n!==t){const r=e.declaredNames?e.declaredNames():[];if(-1==r.indexOf(t))throw Error("LexicalVariable.renamingCapturables: oldName "+t+" is not in declarations {"+r.join(",")+"}");const o=[];a.getNamesInScope(e).map((function(e){e[0]==e[1]?o.push(e[0]):o.push(e[0],e[1])}));const s=r.concat(o);if(-1!=s.indexOf(n))throw Error("LexicalVariable.renameParamRenamingCapturables: newName "+n+" is in existing declarations {"+s.join(",")+"}");if(!e.renameBound)throw Error("LexicalVariable.renameParamRenamingCapturables: block "+e.type+" is not a declaration block.");{const r=i.W.simpleSubstitution(t,n),o=new i.W;e.renameBound(r,o)}}},renameFree:function(e,t){e&&(e.renameFree?e.renameFree(t):e.getChildren().map((function(e){c.renameFree(e,t)})))},freeVariables:function(e){let t=[];if(e)if(e.freeVariables)t=e.freeVariables();else{const n=e.getChildren().map((function(e){return c.freeVariables(e)}));t=s.a.unionAll(n)}else t=new s.a;return t},renameParamWithoutRenamingCapturables:function(e,t,n,r){if(t===n)return t;let s="";o.showPrefixToUser&&(s=this.lexicalVarPrefix);const i=c.renameParamWithoutRenamingCapturablesInfo(e,t,s),l=i[0],u=i[1];let d=[];if(e.declaredNames){d=e.declaredNames();const o=d.indexOf(t);if(-1!=o&&d.splice(o,1),-1!=r.indexOf(n)){const e=d.indexOf(n);-1!=e&&d.splice(e,1)}}const _=c.sortAndRemoveDuplicates(u.concat(d));if((n=a.nameNotIn(n,_))!==t&&-1==d.indexOf(t))for(let e=0;e<l.length;e++){const r=l[e],i=r.renameLexicalVar;i&&i.call(r,o.possiblyPrefixMenuNameWith(s)(t),o.possiblyPrefixMenuNameWith(s)(n))}return n},renameParamWithoutRenamingCapturablesInfo:function(e,t,n){let r=[];e.blocksInScope&&(r=e.blocksInScope());const o=r.map((function(e){return c.referenceResult(e,t,n,[])}));let s=[],i=[];for(let e=0;e<o.length;e++)s=s.concat(o[e][0]),i=i.concat(o[e][1]);return i=c.sortAndRemoveDuplicates(i),[s,i]},checkIdentifier:function(e){const t=e.trim().replace(/[\s\xa0]+/g,"_"),n=new RegExp("^[^-0-9!&%^/>=<`'\"#:;,\\\\*+.()|{}[\\] ][^-!&%^/>=<'\"#:;,\\\\*+.()|{}[\\] ]*$");return{isLegal:0==t.search(n),transformed:t}},makeLegalIdentifier:function(e){const t=c.checkIdentifier(e);return t.isLegal?t.transformed:""===t.transformed?"_":"name"},referenceResult:function(e,t,n,r){if(!e)return[[],[]];const o=e.referenceResults?e.referenceResults(t,n,r):e.getChildren().map((function(e){return c.referenceResult(e,t,n,r)}));let s=[],i=[];for(let e=0;e<o.length;e++)s=s.concat(o[e][0]),i=i.concat(o[e][1]);return[s,i]},sortAndRemoveDuplicates:function(e){const t=e.sort(),n=[];if(e.length>=1){let e=t[0];n.push(e);for(let r=1;r<t.length;r++)t[r]!==e&&(e=t[r],n.push(e))}return n},getNextTargetBlock:function(e){return e&&e.nextConnection&&e.nextConnection.targetBlock()?e.nextConnection.targetBlock():null},stringListsEqual:function(e,t){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}}},793:(e,t,n)=>{n.d(t,{f:()=>o});var r=n(370);n(720);class o extends r.FieldDropdown{constructor(...e){super(...e)}}o.prototype.doClassValidation_=function(e){let t=!1;const n=this.getOptions(!0);for(let r,o=0;r=n[o];o++)if(r[1]===e){t=!0;break}return t||this.generatedOptions.push([e,e]),e},o.fromJson=function(e){return new o(e.options,void 0,e)},r.fieldRegistry.register("field_nocheck_dropdown",o)},701:(e,t,n)=>{n.d(t,{T:()=>i});var r=n(370),o=(n(720),n(917)),s=n(824);class i extends o.G{constructor(e,t,n,r){super(e,t,n,(function(e){if(!i.changeHandlerEnabled)return e;const t=s.f.renameParam.call(this,e);return r&&r.call(this,t),t}))}}i.prototype.fieldCSSClassName="blocklyFieldParameter",i.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown",i.changeHandlerEnabled=!0,i.withChangeHanderDisabled=function(e){const t=i.changeHandlerEnabled;i.changeHandlerEnabled=!1;try{e()}finally{i.changeHandlerEnabled=t}},i.prototype.flydownBlocksXML_=function(){const e=this.getText();return'<xml><block type="lexical_variable_get"><field name="VAR">'+e+'</field></block><block type="lexical_variable_set"><field name="VAR">'+e+"</field></block></xml>"},i.addHorizontalVerticalOption=function(e,t){let n=0;if(e.getParameters&&(n=e.getParameters().length),e.isCollapsed()||n<=0)return;const o={enabled:!0,text:e.horizontalParameters?r.Msg.VERTICAL_PARAMETERS:r.Msg.HORIZONTAL_PARAMETERS,callback:function(){e.setParameterOrientation(!e.horizontalParameters)}};let s=0;for(let e;(e=t[s])&&e.text!=r.Msg.COLLAPSE_BLOCK;s++);t.splice(s,0,o);for(let e,n=0;e=t[n];n++)if(e.text==r.Msg.INLINE_INPUTS){t.splice(n,1);break}},i.fromJson=function(e){const t=r.utils.replaceMessageReferences(e.name);return new i(t,e.is_editable)},r.fieldRegistry.register("field_parameter_flydown",i)},374:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(370),o=(n(720),n(526));class s extends r.FieldTextInput{constructor(e){super(e,o.mQ)}setValue(e){if(this.sourceBlock_&&this.sourceBlock_.isInFlyout)return;const t=this.getValue();if(this.oldName_=t,this.doValueUpdate_(e),super.setValue(e),"string"==typeof(e=this.getValue())&&this.sourceBlock_){const n=this.sourceBlock_.workspace.getProcedureDatabase();n&&(n.getProcedure(this.sourceBlock_.id)?n.renameProcedure(this.sourceBlock_.id,t,e):n.addProcedure(e,this.sourceBlock_))}this.oldName_=void 0}}s.fromJson=function(e){const t=r.utils.replaceMessageReferences(e.name);return new s(t)},r.fieldRegistry.register("field_procedurename",s)},709:(e,t,n)=>{var r=n(624),o=n(370),s=n(127);if(s){const{javascriptGenerator:i}=s;function a(e){const t=r.unprefixName(e),n=t[0],s=t[1];return n===o.Msg.LANG_VARIABLES_GLOBAL_PREFIX||n===r.GLOBAL_KEYWORD?s:r.possiblyPrefixGeneratedVarName(n)(s)}function l(e,t){const n=i.valueToCode(e,"VALUE",i.ORDER_ASSIGNMENT)||"0";return a(e.getFieldValue(t))+" = "+n+";\n"}function c(e){let t="{\n  let ";for(let n=0;e.getFieldValue("VAR"+n);n++)t+=(r.usePrefixInCode?"local_":"")+e.getFieldValue("VAR"+n),t+=" = "+(i.valueToCode(e,"DECL"+n,i.ORDER_NONE)||"0"),t+=", ";return t=t.slice(0,-2),t+=";\n",t}i.lexical_variable_get=function(e){return[a(e.getFieldValue("VAR")),i.ORDER_ATOMIC]},i.lexical_variable_set=function(e){return l(e,"VAR")},i.global_declaration=function(e){return"var "+l(e,"NAME")},i.local_declaration_statement=function(){let e=c(this);return e+=i.statementToCode(this,"STACK",i.ORDER_NONE),e+="}\n",e},i.local_declaration_expression=function(){let e="(function() {\n";return e+=c(this),e+="return "+(i.valueToCode(this,"RETURN",i.ORDER_NONE)||"null"),e+="}})()\n",[e,i.ORDER_NONE]}}if(s){const{javascriptGenerator:u}=s;u.controls_for=function(e){const t=u.nameDB_.getName(e.getFieldValue("VAR"),o.VARIABLE_CATEGORY_NAME),n=u.valueToCode(e,"START",u.ORDER_ASSIGNMENT)||"0",r=u.valueToCode(e,"END",u.ORDER_ASSIGNMENT)||"0",s=u.valueToCode(e,"STEP",u.ORDER_ASSIGNMENT)||"1";let i,a=u.statementToCode(e,"DO");if(a=u.addLoopTrap(a,e),o.utils.string.isNumber(n)&&o.utils.string.isNumber(r)&&o.utils.string.isNumber(s)){const e=Number(n)<=Number(r);i="for (let "+t+" = "+n+"; "+t+(e?" <= ":" >= ")+r+"; "+t;const o=Math.abs(Number(s));i+=1==o?e?"++":"--":(e?" += ":" -= ")+o,i+=") {\n"+a+"}\n"}else{i="";let e=n;n.match(/^\w+$/)||o.utils.string.isNumber(n)||(e=u.nameDB_.getDistinctName(t+"_start",o.VARIABLE_CATEGORY_NAME),i+="let "+e+" = "+n+";\n");let l=r;r.match(/^\w+$/)||o.utils.string.isNumber(r)||(l=u.nameDB_.getDistinctName(t+"_end",o.VARIABLE_CATEGORY_NAME),i+="let "+l+" = "+r+";\n");const c=u.nameDB_.getDistinctName(t+"_inc",o.VARIABLE_CATEGORY_NAME);i+="let "+c+" = ",o.utils.string.isNumber(s)?i+=Math.abs(s)+";\n":i+="Math.abs("+s+");\n",i+="if ("+e+" > "+l+") {\n",i+=u.INDENT+c+" = -"+c+";\n",i+="}\n",i+="for ("+t+" = "+e+"; "+c+" >= 0 ? "+t+" <= "+l+" : "+t+" >= "+l+"; "+t+" += "+c+") {\n"+a+"}\n"}return i},u.controls_forRange=u.controls_for,u.controls_forEach=function(e){const t=u.nameDB_.getName(e.getFieldValue("VAR"),o.VARIABLE_CATEGORY_NAME),n=u.valueToCode(e,"LIST",u.ORDER_ASSIGNMENT)||"[]";let r=u.statementToCode(e,"DO");r=u.addLoopTrap(r,e);let s="",i=n;n.match(/^\w+$/)||(i=u.nameDB_.getDistinctName(t+"_list",o.VARIABLE_CATEGORY_NAME),s+="const "+i+" = "+n+";\n");const a=u.nameDB_.getDistinctName(t+"_index",o.VARIABLE_CATEGORY_NAME);return r=u.INDENT+"const "+t+" = "+i+"["+a+"];\n"+r,s+="for (let "+a+" in "+i+") {\n"+r+"}\n",s}}if(s){const{javascriptGenerator:d}=s;d.procedures_callreturn=function(e){const t=d.nameDB_.getName(e.getFieldValue("PROCNAME"),o.PROCEDURE_CATEGORY_NAME),n=[],r=e.arguments_;for(let t=0;t<r.length;t++)n[t]=d.valueToCode(e,"ARG"+t,d.ORDER_NONE)||"null";return[t+"("+n.join(", ")+")",d.ORDER_FUNCTION_CALL]}}},720:(e,t,n)=>{var r=n(370);r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="initialize global",r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="name",r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="to",r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="global",r.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="Creates a global variable and gives it the value of the attached blocks.",r.Msg.LANG_VARIABLES_GLOBAL_PREFIX="global",r.Msg.LANG_VARIABLES_GET_TITLE_GET="get",r.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="get",r.Msg.LANG_VARIABLES_GET_TOOLTIP="Returns the value of this variable.",r.Msg.LANG_VARIABLES_SET_TITLE_SET="set",r.Msg.LANG_VARIABLES_SET_TITLE_TO="to",r.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="set",r.Msg.LANG_VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",r.Msg.LANG_VARIABLES_VARIABLE=" variable",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="initialize local",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="name",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="to",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="in",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="local",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.",r.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return",r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names",r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="",r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name",r.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x",r.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to",r.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure",r.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do",r.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ",r.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.",r.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result",r.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do",r.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result",r.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.",r.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result",r.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to",r.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure",r.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result",r.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ",r.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.",r.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING="Warning:\nThis procedure has\nduplicate inputs.",r.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ",r.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure",r.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ",r.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.",r.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return",r.Msg.LANG_PROCEDURES_CALLRETURN_CALL="call ",r.Msg.LANG_PROCEDURES_CALLRETURN_PROCEDURE="procedure",r.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ",r.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.",r.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return",r.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs",r.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:",r.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure",r.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="",r.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="",r.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with",r.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x",r.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from",r.Msg.LANG_CONTROLS_FOR_INPUT_TO="to",r.Msg.LANG_CONTROLS_FOR_INPUT_DO="do",r.Msg.LANG_CONTROLS_FOR_TOOLTIP="Count from a start number to an end number.\nFor each count, set the current count number to\nvariable '%1', and then do some statements.",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="for each",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="from",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="to",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="by",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="do",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for",r.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range",r.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP="Runs the blocks in the 'do' section for each numeric value in the range from start to end, stepping the value each time.  Use the given variable name to refer to the current value.",r.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="for each",r.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item",r.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="in list",r.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="do",r.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list",r.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ",r.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list",r.Msg.LANG_CONTROLS_FOREACH_TOOLTIP="Runs the blocks in the 'do'  section for each item in the list.  Use the given variable name to refer to the current list item.",r.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3",r.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do",r.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key",r.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value",r.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary",r.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.",r.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.",r.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition",r.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally",r.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically",r.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do",r.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result",r.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.",r.Msg.LANG_CONTROLS_DO_THEN_RETURN_COLLAPSED_TEXT="do/result",r.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result",r.Msg.PROCEDURES_DEFNORETURN_PROCEDURE=r.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE,r.Msg.PROCEDURES_DEFRETURN_PROCEDURE=r.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE},976:(e,t,n)=>{n.d(t,{a:()=>r});const r=function(e){e||(e=[]),this.elements={};for(let t,n=0;t=e[n];n++)this.elements[t]=!0};r.prototype.isMember=function(e){return!!this.elements[e]},r.prototype.isEmpty=function(){for(let e in this.elements)return!1;return!0},r.prototype.size=function(){let e=0;for(let t in this.elements)e++;return e},r.prototype.toList=function(){const e=[];for(let t in this.elements)e.push(t);return e.sort()},r.prototype.toString=function(){return"NameSet{"+this.toList().join(",")+"}"},r.prototype.copy=function(){const e=new r;for(let t in this.elements)e.insert(t);return e},r.prototype.mirror=function(e){let t;for(t in this.elements)delete this.elements[t];for(t in e.elements)this.elements[t]=!0},r.prototype.insert=function(e){this.elements[e]=!0},r.prototype.deleteName=function(e){delete this.elements[e]},r.prototype.unite=function(e){for(let t in e.elements)this.elements[t]=!0},r.prototype.intersect=function(e){for(let t in this.elements)e.elements[t]||delete this.elements[t]},r.prototype.subtract=function(e){for(let t in this.elements)e.elements[t]&&delete this.elements[t]},r.prototype.rename=function(e){this.mirror(this.renamed(e))},r.prototype.insertion=function(e){const t=this.copy();return t.insert(e),t},r.prototype.deletion=function(e){const t=this.copy();return t.deleteName(e),t},r.prototype.union=function(e){const t=this.copy();return t.unite(e),t},r.prototype.intersection=function(e){const t=this.copy();return t.intersect(e),t},r.prototype.difference=function(e){const t=this.copy();return t.subtract(e),t},r.prototype.renamed=function(e){const t=new r;for(let n in this.elements){const r=e.apply(n);r?t.insert(r):t.insert(n)}return t},r.unionAll=function(e){const t=new r;for(let n,r=0;n=e[r];r++)t.unite(n);return t},r.intersectAll=function(e){if(0===e.length)return new r;{const t=e[0];for(let n,r=1;n=e[r];r++)t.intersect(n);return t}}},526:(e,t,n)=>{n.d(t,{Qp:()=>a,WU:()=>l,k9:()=>i,mQ:()=>c});var r=n(370),o=(n(720),n(824));const s=["",""],i=function(e){let t=this.block.workspace.getTopWorkspace();if(!this.block.isEditable())return void(t=r.Drawer.flyout_.workspace_);const n=t.getProcedureDatabase().getProcedure(e);if(!n)return;const o=n.getFieldValue("NAME");if(""==o||o!=this.getValue())for(let e=0;null!=this.block.getInput("ARG"+e);e++)this.block.removeInput("ARG"+e);this.doValueUpdate_(o),n&&this.block.setProcedureParameters(n.arguments_,n.paramIds_,!0)},a=function(e,t){const n=(t||r.common.getMainWorkspace()).getTopBlocks(),o=[s];for(let t=0;t<n.length;t++){const r=n[t].getFieldValue("NAME");"procedures_defnoreturn"!=n[t].type||e?"procedures_defreturn"==n[t].type&&e&&o.push([r,r]):o.push([r,r])}return o.length>1&&o.splice(0,1),o},l=function(e,t){if(t&&t===r.common.getMainWorkspace()){const n=t.getAllBlocks();for(let t=0;t<n.length;t++){const r=n[t];"procedures_callreturn"!=r.type&&"procedures_callnoreturn"!=r.type||r.getFieldValue("PROCNAME")==e&&r.removeProcedureValue()}}},c=function(e){if(this.sourceBlock_&&this.sourceBlock_.isInFlyout)return e;const t=this.oldName_||this.getValue(),n=e;e=o.f.makeLegalIdentifier(e);const r=function(e){const t=e.workspace.getTopBlocks(!1),n=[];for(let r=0;r<t.length;r++)"procedures_defnoreturn"!==t[r].type&&"procedures_defreturn"!==t[r].type||t[r]!==e&&n.push(t[r]);return n}(this.sourceBlock_).map((function(e){return e.getFieldValue("NAME")}));(e=o.b.nameNotIn(e,r))!==n&&this.doValueUpdate_(e);const s=this.sourceBlock_.workspace.getAllBlocks();for(let n=0;n<s.length;n++){const r=s[n].renameProcedure;r&&r.call(s[n],t,e)}return this.oldName_=e,e}},624:(e,t,n)=>{n.r(t),n.d(t,{GLOBAL_KEYWORD:()=>i,handlerParameterPrefix:()=>l,localNamePrefix:()=>c,loopParameterPrefix:()=>u,loopRangeParameterPrefix:()=>d,menuSeparator:()=>_,possiblyPrefixGeneratedVarName:()=>A,possiblyPrefixMenuNameWith:()=>h,prefixGlobalMenuName:()=>g,prefixSeparator:()=>p,procedureParameterPrefix:()=>a,showPrefixToUser:()=>o,unprefixName:()=>f,usePrefixInCode:()=>s});var r=n(370);n(720);const o=!1,s=!1,i="global",a="input",l="input",c="local",u="item",d="counter",_=" ",p="_",h=function(e){return function(t){return(o?e+_:"")+t}},g=function(e){return r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+_+e},f=function(e){if(0===e.indexOf(r.Msg.LANG_VARIABLES_GLOBAL_PREFIX+_))return[r.Msg.LANG_VARIABLES_GLOBAL_PREFIX,e.substring(r.Msg.LANG_VARIABLES_GLOBAL_PREFIX.length+_.length)];if(0===e.indexOf(i+_))return[i,e.substring(6+_.length)];if(o){const t=[a,l,c,u,d];for(let n=0;n<t.length;n++)if(0===e.indexOf(t[n]))return[t[n],e.substring(t[n].length+_.length)];return["",e]}return["",e]},A=function(e){return function(t){return(s?e+p:"")+t}}},232:(e,t,n)=>{n.d(t,{W:()=>r});const r=function(e,t){if(this.bindings={},r.isAllStringsArray(t)&&r.isAllStringsArray(e)&&e.length===t.length)for(var n=0;n<e.length;n++)this.bindings[e[n]]=t[n];else if(!t&&r.isBindingsObject(e))for(var o in this.bindings={},e)this.bindings[o]=e[o]};r.isAllStringsArray=function(e){if("object"!=typeof e||!e.length)return!1;for(var t=0;t<e.length;t++)if("string"!=typeof e[t])return!1;return!0},r.isBindingsObject=function(e){if("object"!=typeof e)return!1;for(var t in e)if("string"!=typeof t||(e[t],0))return!1;return!0},r.simpleSubstitution=function(e,t){var n={};return n[e]=t,new r(n)},r.prototype.apply=function(e){return this.bindings[e]||e},r.prototype.map=function(e){const t=this;return e.map((function(e){return t.apply(e)}))},r.prototype.toString=function(){var e=[];for(var t in this.bindings)e.push(t+":"+this.bindings[t]);return"Substitution{"+e.sort().join(",")+"}"},r.prototype.copy=function(){var e=new r;for(var t in this.bindings)e.bindings[t]=this.bindings[t];return e},r.prototype.restrictDomain=function(e){for(var t=new r,n=0;n<e.length;n++){var o=this.bindings[e[n]];o&&(t.bindings[e[n]]=o)}return t},r.prototype.remove=function(e){var t=new r;for(var n in this.bindings)-1==e.indexOf(n)&&(t.bindings[n]=this.bindings[n]);return t},r.prototype.extend=function(e){var t=this.copy();for(var n in e.bindings)t.bindings[n]=e.bindings[n];return t},r.prototype.domain=function(){var e=[];for(var t in this.bindings)e.push(t);return e.sort()},r.prototype.getBindings=function(){var e={};for(var t in this.bindings)e[t]=this.bindings[t];return e}},653:(e,t,n)=>{n.d(t,{bO:()=>i,i0:()=>l,xb:()=>a});var r=n(370);n(720);const o=function(e,t){return e.sourceBlock_.rendered&&t.sourceBlock_.rendered?!t.check_||t.check_.includes("InstantInTime"):(t.check_&&!t.check_.includes("InstantInTime")&&t.sourceBlock_.badBlock(),!0)},s={number:{input:["Number"],output:["Number","String","Key"]},text:{input:["String"],output:["Number","String","Key"]},boolean:{input:["Boolean"],output:["Boolean","String"]},list:{input:["Array"],output:["Array","String"]},component:{input:["COMPONENT"],output:["COMPONENT","Key"]},InstantInTime:{input:["InstantInTime",o],output:["InstantInTime",o]},any:{input:null,output:null},dictionary:{input:["Dictionary"],output:["Dictionary","String","Array"]},pair:{input:["Pair"],output:["Pair","String","Array"]},key:{input:["Key"],output:["String","Key"]}},i="input",a=function(e,t){const n=s[e][t];if(void 0===n)throw new Error("Unknown Yail type: "+e+" -- YailTypeToBlocklyType");return n},l=function(e){return void 0!==e.children?e.children:Array.prototype.filter.call(e.childNodes,(function(e){return e.nodeType==r.utils.dom.NodeType.ELEMENT_NODE}))}},605:(e,t,n)=>{n.d(t,{A:()=>o,N:()=>s});var r=n(370);n(720);class o{checkErrors(e){if(e.getSvgRoot&&!e.getSvgRoot()||e.readOnly)return e.hasWarning&&(e.hasWarning=!1),void(e.hasError&&(e.hasError=!1));e.errors||(e.errors=[]),e.warnings||(e.warnings=[]);const t=e.errors,n=e.warnings;for(let n=0;n<t.length;n++)if(t[n].func&&t[n].func.call(this,e,t[n]))return e.hasError||(e.hasError=!0),void(e.hasWarning&&(e.hasWarning=!1));e.hasError&&(e.hasError=!1);for(let t=0;t<n.length;t++)if(n[t].func&&n[t].func.call(this,e,n[t]))return void(e.hasWarning||(e.hasWarning=!0));e.warning&&e.setWarningText(null),e.hasWarning&&(e.hasWarning=!1)}setError(e,t){e.setWarningText(t)}setWarning(e,t){e.setWarningText(t)}}class s{static checkIsInDefinition(e){if("global_declaration"===e.getRootBlock().type){const t=r.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION;return e.workspace.getWarningHandler().setError(e,t),!0}return!1}static checkDropDownContainsValidValue(e,t){if(e.workspace.isDragging&&e.workspace.isDragging())return!1;for(let n=0;n<t.dropDowns.length;n++){const o=e.getField(t.dropDowns[n]),s=o.menuGenerator_(),i=o.getText(),a=o.getValue();let l=!1;o.updateMutation&&o.updateMutation();for(let e=0;e<s.length;e++)if(s[e][1]===a&&" "!==a){l=!0,s[e][0]!==i&&o.setValue(s[e][0]);break}if(!l){const t=r.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN;return e.workspace.getWarningHandler().setError(e,t),!0}}return!1}}}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return n[e](s,s.exports,o),s.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{LexicalVariablesPlugin:()=>e.LexicalVariablesPlugin});var e=o(486);o(90),o(709)})(),s})()));
//# sourceMappingURL=index.js.map